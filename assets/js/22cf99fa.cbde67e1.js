"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5100],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>v});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=c(n),d=a,v=u["".concat(p,".").concat(d)]||u[d]||m[d]||o;return n?r.createElement(v,l(l({ref:t},s),{},{components:n})):r.createElement(v,l({ref:t},s))}));function v(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[u]="string"==typeof e?e:a,l[1]=i;for(var c=2;c<o;c++)l[c]=n[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2454:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const o={},l="volatile",i={unversionedId:"cpp/volatile",id:"cpp/volatile",title:"volatile",description:"volatile tells the compiler that:",source:"@site/docs/cpp/7. volatile.md",sourceDirName:"cpp",slug:"/cpp/volatile",permalink:"/cpp/cpp/volatile",draft:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"inline",permalink:"/cpp/cpp/inline"},next:{title:"assert()",permalink:"/cpp/cpp/assert"}},p={},c=[],s={toc:c};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"volatile"},"volatile"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"volatile int i = 10;\n")),(0,a.kt)("p",null,"volatile tells the compiler that:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\"Hey compiler, I'm volatile and, you know, I can be changed by some XYZ that you're not even aware of. That XYZ could be anything. Maybe some alien outside this planet called program. Maybe some lightning, some form of interrupt, volcanoes, etc can mutate me. Maybe. You never know who is going to change me! So O you ignorant, stop playing an all-knowing god, and don't dare touch the code where I'm present. Okay?\"")),(0,a.kt)("p",null,"volatile \u5173\u952e\u5b57\u662f\u4e00\u79cd\u7c7b\u578b\u4fee\u9970\u7b26\uff0c\u7528\u5b83\u58f0\u660e\u7684\u7c7b\u578b\u53d8\u91cf\u8868\u793a\u53ef\u4ee5\u88ab\u67d0\u4e9b\u7f16\u8bd1\u5668\u672a\u77e5\u7684\u56e0\u7d20\u66f4\u6539\u3002\u6bd4\u5982\uff1a\u64cd\u4f5c\u7cfb\u7edf\u3001\u786c\u4ef6\u6216\u8005\u5176\u5b83\u7ebf\u7a0b\u7b49\u3002\u9047\u5230\u8fd9\u4e2a\u5173\u952e\u5b57\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u7f16\u8bd1\u5668\u5bf9\u8bbf\u95ee\u8be5\u53d8\u91cf\u7684\u4ee3\u7801\u5c31\u4e0d\u518d\u8fdb\u884c\u4f18\u5316\uff0c\u4ece\u800c\u53ef\u4ee5\u63d0\u4f9b\u5bf9\u7279\u6b8a\u5730\u5740\u7684",(0,a.kt)("strong",{parentName:"p"},"\u7a33\u5b9a\u8bbf\u95ee"),"\u3002"),(0,a.kt)("p",null,"\u6309\u7167 Hans Boehm & Nick Maclaren \u7684\u603b\u7ed3\uff0cvolatile \u53ea\u5728\u4e09\u79cd\u573a\u5408\u4e0b\u662f\u5408\u9002\u7684\u3002"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u548c\u4fe1\u53f7\u5904\u7406\uff08signal handler\uff09\u76f8\u5173\u7684\u573a\u5408\uff1b"),(0,a.kt)("li",{parentName:"ol"},"\u548c\u5185\u5b58\u6620\u5c04\u786c\u4ef6\uff08memory mapped hardware\uff09\u76f8\u5173\u7684\u573a\u5408\uff1b"),(0,a.kt)("li",{parentName:"ol"},"\u548c\u975e\u672c\u5730\u8df3\u8f6c\uff08setjmp \u548c longjmp\uff09\u76f8\u5173\u7684\u573a\u5408\u3002")),(0,a.kt)("p",null,"\u4e00\u4e2a\u4fe1\u53f7\u5904\u7406\u7684\u4f8b\u5b50\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},'#include <cstdio>\n#include <signal.h>\n\nvolatile bool sigarrived = false;\n\nvoid handler(int sig) {\n  if (sig == SIGINT) {\n    sigarrived = true;\n  }\n}\n\nint main() {\n  printf("Waiting. Press Ctrl-C to move on. \\n");\n  signal(SIGINT, handler);\n  while (!sigarrived) {\n  }\n  printf("Ok. Moving on.\\n");\n  return 0;\n}\n')),(0,a.kt)("p",null,"\u5982\u679c\u8fd9\u91cc\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"sigarrived")," \u4e0d\u52a0 ",(0,a.kt)("inlineCode",{parentName:"p"},"volatile")," \u5173\u952e\u5b57\uff0c\u90a3\u4e48\u7f16\u8bd1\u5668\u4f1a\u5bf9\u4ee3\u7801\u8fdb\u884c\u4f18\u5316\uff0c\u5c06 ",(0,a.kt)("inlineCode",{parentName:"p"},"while(!sigarrived)")," \u4f18\u5316\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"while(true)"),"\uff0c\u8fd9\u6837\u662f\u4e0d\u597d\u7684\u3002"),(0,a.kt)("p",null,"C++ \u591a\u7ebf\u7a0b\u60c5\u51b5\u4e0b\u4e0d\u5e94\u8be5\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"volatile"),"\uff0c\u5e94\u8be5\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"atomic"),"\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"conditional_variable")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"mutex"),"\u3002"))}u.isMDXComponent=!0}}]);